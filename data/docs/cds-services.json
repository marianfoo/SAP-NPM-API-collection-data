[{"name":"CHANGELOG.md","content":"# Changelog\r\n\r\nAll notable changes to this project will be documented in this file.\r\n\r\nThis project adheres to [Semantic Versioning](http://semver.org/).\r\n\r\nThe format is based on [Keep a Changelog](http://keepachangelog.com/).\r\n\r\n\r\n## Version 1.27.2 - 2020-08-12\r\n\r\n### Fixed\r\n- README and LICENSE\r\n\r\n## Version 1.27.1 - 2020-03-23\r\n\r\n### Fixed\r\n\r\n- Alias was added twice to CQN in case of a request including navigations on a draft enabled entity\r\n\r\n## Version 1.27.0 - 2020-03-19\r\n\r\n### Added\r\n\r\n- Transaction uses one timestamp for all queries\r\n- Pool acquire timeout is set by default and can be configured in pool options\r\n- Ordered OData singletons (`... as select from <entity> order by <property>`)\r\n\r\n### Changed\r\n\r\n- $count=true triggers handlers only once now\r\n- `draftPrepare` action can be called on the entity set of child nodes of the draft enabled entity\r\n- Normalize user.id if an email address\r\n- Allow functions and properties as 2nd param in contains, startswith, endswith\r\n\r\n### Fixed\r\n\r\n- Entity is now correctly resolved if there are conflicting names\r\n- Where conditions from security annotations were appended twice when using $count=true\r\n- `req._.req` always contains the incoming request - also in `$batch` requests\r\n- Error in delete when fields are renamed in views\r\n- Using view by draft & localized\r\n- context.diff() returns changes also for `PATCH` of drafts\r\n- OData requests using `/$count` on navigation-to-many\r\n- Authentication-requirement detected if in multi tenant mode (i.e., `multiTenant: true`)\r\n- Integrity check of atomicity group\r\n- Where annotation in case of draft and navigations\r\n- `/$count` on parameterized views\r\n- Streaming from draft in case localized and where annotations\r\n- @mandatory: empty strings (whitespaces only = empty) are not allowed\r\n\r\n## Version 1.25.1 - 2020-02-26\r\n\r\n### Fixed\r\n\r\n- update of localized text entries replies with 403 if no changes are detected\r\n\r\n### Removed\r\n\r\n- `npm-shrinkwrap.json`\r\n\r\n## Version 1.25.0 - 2020-02-25\r\n\r\n### Added\r\n\r\n- Support for OData singletons\r\n- Streaming from draft\r\n- Navigations in aggregate expressions\r\n\r\n### Changed\r\n\r\n- use odata-server 1.5.2\r\n\r\n### Fixed\r\n\r\n- handling of virtual field in column generation\r\n- callstack exceeded in SELECT\r\n\r\n## Version 1.24.1 - 2020-02-21\r\n\r\n### Added\r\n\r\n- Support draft for localized texts (to be enabled by @sap/cds and @sap/cds-compiler)\r\n\r\n## Version 1.24.0 - 2020-02-20\r\n\r\n### Added\r\n\r\n- Support for OData `$apply` with `count distinct`\r\n\r\n### Changed\r\n\r\n- use odata-server 1.5.1\r\n\r\n### Fixed\r\n\r\n- Column generation for `SELECT.from()` queries without specifying `.columns()`\r\n  - `HasDraftEntity` was not properly calculated\r\n  - Virtual properties were not excluded\r\n- Where secure annotations with localized entities\r\n- Handling of `@cds.on.insert/update` annotated properties of draft-enabled entities\r\n- Keys in root element were not correctly calculated for deep operations\r\n- `@Core.MediaType` could not be used in entity annotated with `@cds.persistence.skip` \r\n\r\n### Removed\r\n\r\n- Annotation `@Search.fuzzinessThreshold`\r\n\r\n## Version 1.23.0 - 2020-02-05\r\n\r\n### Added\r\n\r\n- Support non-UUID field as ETags\r\n- Support draft and ETags\r\n- Support for complex where in annotations\r\n- Additional argument `target` for `req.info`\r\n\r\n### Changed\r\n\r\n- Direct access to auto-exposed entities in draft case\r\n- Errors normalized based on OData v4 standard\r\n- Messages (i.e., header `sap-messages`) normalized based on Fiori standard\r\n- Referential integrity checks are now executed before the commit\r\n- Result of create and update queries is read from the data source to include computed values (update: root only, i.e., w/o compositons, etc.)\r\n\r\n### Fixed\r\n\r\n- Race condition when there are erros when saving draft\r\n- Handling of where from @restrict annotation of draft enabled entity\r\n- Saving a draft will not ignore readonly fields anymore\r\n- Not having a connection for unauthorized users will not crash the server anymore\r\n- In mocked authorization, users don't need the `ID` property\r\n- Filtering using the `NE` operator handles null values properly\r\n- For insertable-only entities default values are correctly handled now\r\n- Immutable values are now ignored during PATCH or UPDATE requests\r\n- Batch input via REST\r\n- SELECT * by customer handlers will work also on Hana in case the columns are lowercase\r\n- Support \"userAttributes\" by Mocked Authentication, \"xs.user.attributes\" is deprecated and will\r\nbe removed in the next releases\r\n- Arbitrary users are allowed if fake user '*'= true exist by Mocked Authentication\r\n\r\n## Version 1.22.0 - 2019-12-11\r\n\r\n### Added\r\n\r\n- @sap/cds-ql merged into @sap/cds-services\r\n- Support for subselects and aliasing for remote service definitions\r\n- Support for `@cds.persistence.table`.\r\n- Actions/functions support $select and $expand query params in odata\r\n- Support cds annotation on insert and update with # (e.g @cds.on.update: #user)\r\n\r\n### Changed\r\n\r\n- Improve error messages for return type validation of custom operations\r\n- Draft removal is handled in `onDraftActivateEvent` instead of `onDraftActivate`\r\n\r\n### Fixed\r\n\r\n- Check whether service requires authentication\r\n- Independent passport configs per service\r\n\r\n## Version 1.21.2 - 2019-12-03\r\n\r\n### Fixed\r\n\r\n- Default values for patch\r\n\r\n## Version 1.21.1 - 2019-11-29\r\n\r\n### Added\r\n\r\n- Authentication strategy debug messages and error messages for erroneous authentication configurations\r\n\r\n### Fixed\r\n\r\n- Transform redirect properties in post processing\r\n\r\n## Version 1.21.0 - 2019-11-19\r\n\r\n### Added\r\n\r\n- Support for reading temporal data on HANA\r\n- Support ETag at odata-v4\r\n\r\n### Fixed\r\n\r\n- Key generation in deep update\r\n- Reading `DraftAdministrativeData` of an active entry without existing draft\r\n\r\n## Version 1.20.1 - 2019-10-30\r\n\r\n### Changed\r\n\r\n- Updated version of @sap/cds-ql to 1.20.1\r\n\r\n## Version 1.20.0 - 2019-10-29\r\n\r\n### Added\r\n\r\n- `req.method` property which contains the HTTP method\r\n- Return type validation for custom operations in rest\r\n- Support for redirected media properties using `@Core.IsURL`\r\n\r\n### Fixed\r\n\r\n- Requests to `$metadata`\r\n\r\n### Removed\r\n\r\n- `npm-shrinkwrap.json`\r\n- `req._.isPatch`\r\n\r\n## Version 1.19.1 - 2019-10-16\r\n\r\n### Changed\r\n\r\n- Improved error messages\r\n\r\n### Fixed\r\n\r\n- Empty user attributes in where conditions\r\n- Queries in custom handler executed twice\r\n\r\n## Version 1.19.0 - 2019-10-02\r\n\r\n### Added\r\n\r\n- Check of source for navigation-to-one in not Draft case\r\n- log function in default logger\r\n\r\n### Changed\r\n\r\n- Improved error messages\r\n- Use `@sap/odata-server@1.3.8`\r\n\r\n### Fixed\r\n\r\n- Draft service having column names from draft admin table\r\n- POST and PUT on views with renaming and excluding\r\n- Draft with custom `oncond` in backlink\r\n- Batch with multitenancy\r\n\r\n## Version 1.18.2 - 2019-09-19\r\n\r\n### Changed\r\n\r\n- Use `@sap/odata-server@1.3.7`\r\n\r\n## Version 1.18.1 - 2019-09-18\r\n\r\n### Added\r\n\r\n- Support of authorization restrictions with simple static where clauses (e.g. `$user.level = 3`) for actions/functions\r\n\r\n### Fixed\r\n\r\n- Draft activation by multiple views\r\n- Binary processing in rest adapter\r\n\r\n## Version 1.18.0 - 2019-09-09\r\n\r\n### Added\r\n\r\n- Support for `@assert.enum` annotation\r\n- Support for media content-type provided as property\r\n- Support for binary encoding in rest\r\n\r\n### Changed\r\n\r\n- Use `@sap/odata-server@1.3.5`\r\n\r\n### Fixed\r\n\r\n- READ with `@cds.api.ignore` annotation\r\n- Navigation on Entities with multiple keys did not work correctly\r\n- UPDATE and UPSERT requests with `@cds.on.update` and `@cds.on.insert` annotations\r\n- Logging of missing permissions if no authentication strategy is detected\r\n\r\n## Version 1.17.0 - 2019-08-21\r\n\r\n### Added\r\n\r\n- Error handling for streaming\r\n- Limited support for CREATE requests via navigations\r\n- Method `.transaction` to local client\r\n\r\n### Changed\r\n\r\n- CREATE with WHERE restriction is supported only with static checks, otherwise rejected\r\n- Extended error logs from custom handlers\r\n- `next()` returns the result of the subsequent handler\r\n- Use `@sap/cds-messaging` for sending/receiving events between services\r\n\r\n### Fixed\r\n\r\n- Expand entity with where restriction when clause references a user attribute with multiple values\r\n- Navigations in `get` requests using `cds.String` as key type\r\n- Deletion of active entries during draft activation\r\n- Checking security annotations in service and in entities\r\n- UUID generation for deep inserts/updates\r\n- Combination of `localized data` and `$count=true` in OData requests\r\n- `req.query` in case of bound actions and reached via navigation\r\n\r\n## Version 1.16.0 - 2019-07-23\r\n\r\n### Added\r\n\r\n- Batch Update in REST Adapter using an Array as request body\r\n- Content-Type for streaming using annotation\r\n- `DELETE` requests on an entity property sets the property to `null`\r\n- Integrity check for `DELETE` requests\r\n\r\n### Changed\r\n\r\n- Behaviour of mock authentication according to documentation\r\n- `cds.env` is used by authentication if passport not provided in options\r\n\r\n### Fixed\r\n\r\n- Draft actions for localized entities\r\n- Write localized data via deep update/insert\r\n\r\n## Version 1.15.0 - 2019-07-09\r\n\r\n### Added\r\n\r\n- Support for views with parameters\r\n- Support for `filter` transformation in `$apply`\r\n- Support for `/$value` on primitive properties\r\n\r\n### Changed\r\n\r\n- Rest adapter accepts non-modelled data fields in the request payload and exposes them in `req.data`; the fields are\r\n ignored in the generic handlers\r\n- Replaced `@sap/cds-ql` dependency with `uuid`\r\n\r\n### Fixed\r\n\r\n- Custom handlers by extended tenants\r\n- Generic handler lookup if multiple services in one `.cds` file\r\n- `$expand` with instance-based authorization\r\n- `result` parameter in AfterHandler has correct format (not always an array)\r\n  - `CREATE`: the created entity\r\n  - `UPDATE`: the updated entity\r\n  - `DELETE`: undefined\r\n  - for `actions` and `functions` it is the defined return type\r\n- `@cds.on.insert` and `@cds.on.update` could not be used at the same time\r\n- `@cds.on.insert` and `@cds.on.update` in deep insert / update\r\n\r\n## Version 1.14.0 - 2019-06-24\r\n\r\n### Added\r\n\r\n- Alternative mock strategy config\r\n- Support for value ranges annotations for REST adapter\r\n- Multiple authentication strategies\r\n\r\n### Changed\r\n\r\n- Handling of deep insert / update for associations\r\n- Use `@sap/odata-server@1.3.4`\r\n\r\n### Fixed\r\n\r\n- Bound actions for draft-enabled entities\r\n- Combination of `$apply` with other query parameters\r\n\r\n### Removed\r\n\r\n- Caching of metadata as odata already does it\r\n\r\n## Version 1.13.0 - 2019-06-07\r\n\r\n### Added\r\n\r\n- Method `diff` to calculate the actual changes in a `CUD`request or while saving a draft\r\n- Support authorization annotations for actions and functions\r\n- Support for default sort order using `@cds.default.order` or `@odata.default.order`\r\n- Support for writing binary stream through odata\r\n\r\n## Version 1.12.0 - 2019-05-24\r\n\r\n### Added\r\n\r\n- Support for localized in generic handlers (no compositions / associations)\r\n- Handler registration by path for autoexposed and redirected entities\r\n- Support for Rest parametric functions and actions\r\n\r\n### Changed\r\n\r\n- Renamed `Service.with` to `Service.impl`\r\n\r\n### Fixed\r\n\r\n- `falsy` values as default value\r\n- `req.info` in case of draft actions\r\n- Scopes are checked before custom before handlers\r\n\r\n## Version 1.11.1 - 2019-05-16\r\n\r\n### Changed\r\n\r\n- `service.options` is now a public property (previously private as `service._options`)\r\n\r\n## Version 1.11.0 - 2019-05-15\r\n\r\n### Added\r\n\r\n- read-only field annotations validation\r\n- Deactivate ResourceJsonSerializer in production\r\n- Validation for content type in rest adapter\r\n- Support for OData request path expressions Ã  la `Authors/1`\r\n\r\n### Changed\r\n\r\n- Use `@sap/odata-server@1.3.3`\r\n\r\n## Version 1.10.2 - 2019-05-08\r\n\r\n### Added\r\n\r\n- Support for @Capabilities annotations\r\n\r\n### Changed\r\n\r\n- Improved performance by reducing calls to process.nextTick()\r\n\r\n### Fixed\r\n\r\n- Unbound actions and functions in REST\r\n\r\n## Version 1.10.1 - 2019-05-07\r\n\r\n### Added\r\n\r\n- error handling in case mtx errors\r\n\r\n### Changed\r\n\r\n- Handler registration using `.with` (as done in reuse scenarios)\r\n\r\n### Fixed\r\n\r\n- Using `$select=association` in odata-v4 adapter\r\n\r\n## Version 1.10.0 - 2019-05-03\r\n\r\n### Added\r\n\r\n- Support for reading streams in `odata v4`\r\n- Support for batch create in REST adapter\r\n- Support for combination of scopes and instance based authorization checks\r\n- Fiori Draft event `SAVE` as alias for `CREATE` and `UPDATE`\r\n\r\n### Changed\r\n\r\n- Improved performance\r\n\r\n## Version 1.9.0 - 2019-04-16\r\n\r\n### Added\r\n\r\n- 'mock' strategy accepts any user credentials if none configured\r\n- Support for pseudo role 'system-user'\r\n- Additional cases at security annotations\r\n- `sap-statistics=true` as query or header parameter will yield performance statistics\r\n- $top and $skip at rest adapter\r\n\r\n### Changed\r\n\r\n- Handlers for `failed` events must only have the error object as an argument\r\n- Handlers for `succeeded` and `done` events must have no argument at all\r\n- used new function notation in generated CQN\r\n- Reduction of round trips to data source by not using transactional blocks at reading requests\r\n\r\n### Fixed\r\n\r\n- Deep operations in REST adapter\r\n- Draft edit in case one composition has no entries\r\n\r\n## Version 1.8.1 - 2019-04-03\r\n\r\n### Fixed\r\n\r\n- Events are populated through `req.event`\r\n\r\n## Version 1.8.0 - 2019-03-29\r\n\r\n### Added\r\n\r\n- after handlers using `each` or `row` also work with keyword `async`\r\n\r\n### Changed\r\n\r\n- Generic `onCommit` or `onRollback` handlers end the transaction of potentially multiple db sessions in the request\r\ncontext\r\n- Merged client adapter into service\r\n\r\n### Fixed\r\n\r\n- Errors not of type Error are not recognized\r\n- `req.target` in case of a `READ` request of the `DraftAministrativeData` entity\r\n\r\n## Version 1.7.2 - 2019-03-25\r\n\r\n### Added\r\n\r\n- Element/Field annotated with `@mandatory` or `@FieldControl.Mandatory` is treated as not null\r\n- Added 'mock' strategy for passport\r\n- Complex cases at security annotations\r\n- When registering custom handlers for transactional draft events the target property of the `req` parameter now points to the draft\r\n\r\n## Version 1.7.1 - 2019-03-20\r\n\r\n### Fixed\r\n\r\n- Passport is registered correctly in case of `cds.serve('all')`\r\n- User is now set before it is needed\r\n\r\n## Version 1.7.0 - 2019-03-19\r\n\r\n### Added\r\n\r\n- `req.event` contains the type or name of the incoming request\r\n- Support for specifying a `target` in `req.error` and  `req.reject`\r\n- `req.info` to collect info messages in odata-v4. Eventually, they result in the `sap-messages` header.\r\n- Annotation `@Search.fuzzinessThreshold` to configure Fuzzy Search\r\n- Support for Extensibility\r\n- Event handlers for events `succeeded`, `failed` and `done` can be registered at the service event context\r\n- Support for OData `Arithmetic Functions`, `Date and Time Functions`, `String Functions`\r\n\r\n### Changed\r\n\r\n- before handlers are executed in parallel\r\n- `req.error` returns a generic error with all collected errors in `.details`\r\n- passport method is extracted to the package interface\r\n\r\n### Fixed\r\n\r\n- No SQL error in case key is generated by DB like done with sequences\r\n\r\n## Version 1.6.0 - 2019-02-25\r\n\r\n### Added\r\n\r\n- Support for `Lambda operators`\r\n\r\n### Fixed\r\n\r\n- CUD operation with association as key of entity\r\n\r\n## Version 1.5.2 - 2019-02-13\r\n\r\n### Added\r\n\r\n - Support for sql functions lower, upper, trim, length in $filter and $orderby\r\n\r\n### Changed\r\n\r\n- Sync functions at before and after handler are not wrapped in promise anymore\r\n- req.reject does not throw anymore\r\n- @sap/audit-logging only used in case the service is provided via VCAP_SERVICES\r\n- Unknown query parameters are not longer rejected at REST adapter\r\n\r\n### Fixed\r\n\r\n- OData version for $metadata\r\n- Multiple atomicity groups should not share same transaction block\r\n- Brackets in $filter now work correctly\r\n\r\n## Version 1.5.1 - 2019-02-12\r\n\r\n### Changed\r\n\r\n- @sap/audit-logging only used in case the service is provided via VCAP_SERVICES\r\n\r\n### Fixed\r\n\r\n- No integrity checks when running without db connection\r\n\r\n\r\n## Version 1.5.0 - 2019-02-07\r\n\r\n### Added\r\n\r\n- Set foreign keys for POST via `navigation-to-many` and modeled with `$self`\r\n- Support `content id` placeholders in odata v4 batch requests\r\n- Support complex cases at security annotations\r\n\r\n### Changed\r\n\r\n- Referential integrity checks do not run for associations with specified on conditions\r\n- Rest adapter now ignores query parameters\r\n- Minimum node version 8.9.0\r\n- `.data` and `.query` can be overwritten\r\n\r\n### Fixed\r\n\r\n- Insert with excluded properties having default values\r\n- Delete active documents in a draft-enabled service without a draft\r\n- Path segment `/$count` respects `$filter`\r\n\r\n## Version 1.4.0 - 2019-01-22\r\n\r\n### Added\r\n\r\n- When registering service handlers, entities can be given as a list\r\n- Support requests to /SiblingEntity in draft\r\n- Annotation `@cds.integrity.skip` to disable reference integrity checks (experimental!)\r\n\r\n### Changed\r\n\r\n- Replaced @sap/odata-v4 by @sap/odata-server\r\n\r\n## Version 1.3.0 - 2019-01-11\r\n\r\n### Added\r\n\r\n- Authorization filtering and user attributes as lists\r\n- Referential integrity checks\r\n\r\n### Fixed\r\n\r\n- No fallback for user identifier in case the user object is empty\r\n- Reading draft administrative data\r\n\r\n## Version 1.2.0 - 2018-12-21\r\n\r\n### Added\r\n\r\n- Set default values in case of CREATE, UPSERT and adding a child in deep documents\r\n\r\n### Changed\r\n\r\n- `context.draftMetadata` contains draft metadata\r\n- `context.isDraftChange` indicates only changes in drafts\r\n- Error messages to be more consistent\r\n\r\n### Fixed\r\n\r\n- On handler registration for custom handlers in draft\r\n- Draft children can be deleted without navigations\r\n- Reading all draft-enabled documents takes into account only own drafts\r\n\r\n### Removed\r\n\r\n## Version 1.1.0 - 2018-12-12\r\n\r\n### Added\r\n\r\n- Deep Document Calls (deep insert, deep update and cascade delete)\r\n- `context.draft` contains draftUUID in case of Create, Update or Delete\r\n- filter and orderby with navigation\r\n\r\n### Changed\r\n\r\n- improved error messages\r\n\r\n- Activating a draft now triggers the 'UPDATE' or 'CREATE' event\r\n\r\n### Fixed\r\n\r\n- Create Draft uses default values\r\n- draftActivate uses correct keys for update\r\n- $count in draft context now calculates correct result\r\n- db view with select\r\n- Support for navigation over draft with count\r\n- .code property of Errors in Custom handlers will not be overwritten\r\n\r\n## Version 1.0.0 - 2018-11-27\r\n\r\n### Added\r\n\r\n- Support for now function in $filter\r\n- Support for authorization annotations CREATE, UPDATE, DELETE\r\n- Conversion of cds.DateTime/Timestamp using UTC\r\n- Entity definition at service as select view\r\n\r\n### Changed\r\n\r\n- Update entry makes insert if the entry doesn't exist\r\n- Log messages are used directly instead of being wrapped\r\n- Bound functions now have a query value\r\n- Function next is implicitly executed in synchronous on-handlers\r\n- Improved error handling\r\n- Handler registration allows following variations:\r\n    - Array of events: e.g. ['READ', 'UPDATE']\r\n    - '*' wildcard for any entity event\r\n- next() throws error if called twice in same handler\r\n- Custom implementation must be provided via .with\r\n- Renamed service.definition to service.model\r\n- Renamed service.service to service.name\r\n- updated odata-v4 version to 1.8.0\r\n- Location header for draft actions is now relative\r\n\r\n### Fixed\r\n\r\n- POST on existing entity throws 'Bad Request'\r\n- $search and $filter in combination with some read draft cases\r\n- POST with navigation does not create a new key\r\n- Access restriction on service level\r\n- UPDATE sql statement generated wrong for entity with multiple keys\r\n- Access to user's locale\r\n- draftEdit action on entities without children\r\n- CREATE with not nullable elements\r\n\r\n## Version 0.12.0 - 2018-10-17\r\n\r\n### Added\r\n\r\n- Custom handlers can be registered and executed for bound functions and function imports\r\n- Added BeforeCreate and BeforeCreateDraft handlers to generate needed UUIDs\r\n\r\n### Changed\r\n\r\n- Removed translator in the insert based on where by instanced based authorization\r\n- Removed internal event rejections\r\n- Not found error message generalized for reading through navigation\r\n- Refactoring and changes due to updated dependencies\r\n\r\n## Version 0.11.0 - 2018-10-04\r\n\r\n### Added\r\n\r\n- Generic support for Create, Update, Delete on draft-enabled entities\r\n- Generic support for draftEdit, draftPrepare, draftActivate actions\r\n- Logger is available in handlers via context.log\r\n\r\n### Changed\r\n\r\n- Log warning if database connection is missing\r\n\r\n### Fixed\r\n\r\n- Service requests now return promises instead of thenables\r\n\r\n## Version 0.10.1 - 2018-09-18\r\n\r\n### Added\r\n\r\n- Generic support for Read on draft-enabled entities\r\n\r\n### Fixed\r\n\r\n- $user annotation works without authorization\r\n\r\n## Version 0.10.0 - 2018-09-17\r\n\r\n### Added\r\n\r\n- Delete Draft\r\n- Audit Logging of GDPR related events\r\n- Auto lookup of to be used CF/XSA services from environmental VCAP_SERVICES\r\n- OData to context.query for nested $filter, $orderby, $op and $skip at $expand\r\n- Custom types on top of associations\r\n\r\n### Changed\r\n\r\n- Default for maxPageSize increased to 1000 from 100\r\n\r\n### Fixed\r\n\r\n- Values for annotated columns (user/now) are included in the response\r\n\r\n## Version 0.9.2 - 2018-09-05\r\n\r\n### Changed\r\n\r\n- Improved npm-shrinkwrap\r\n\r\n## Version 0.9.1 - 2018-09-03\r\n\r\n### Added\r\n\r\n- Create draft\r\n\r\n### Removed\r\n\r\n- implicit dependency to @sap/cds-sql\r\n\r\n## Version 0.9.0 - 2018-08-28\r\n\r\n### Added\r\n\r\n- API to support the implementation of authorization restrictions\r\n- Local service client\r\n- Support for to-one-navigation in $filter\r\n- Support for annotation @Search.defaultSearchElement to restrict searchable columns in $search\r\n- Support for sap-language query parameter\r\n- Support authorization annotations\r\n- Hooks to add custom logic before and after rollback event\r\n- Audit Logging of security events\r\n\r\n### Fixed\r\n\r\n- Pagination in case of $expand\r\n- $select with managed associations as key\r\n\r\n## Version 0.8.1 - 2018-08-09\r\n\r\n### Added\r\n\r\n- Authentication using passport (including user/attr proxy)\r\n\r\n### Changed\r\n\r\n- Require submodules on demand\r\n\r\n## Version 0.8.0 - 2018-08-07\r\n\r\n### Added\r\n\r\n- OData Service: $search supports Unary and Binary Expressions without brackets\r\n- Registration of global handler using star symbol like \"this.on('*', () => {})\"\r\n- Registration of express middleware using this.use()\r\n- Improved FeautureNotSupported error message\r\n- context.reject supported for before, on and after handlers\r\n<!-- Was never documented publicly: - Support of context.run().then.run() shortcut -->\r\n\r\n### Changed\r\n\r\n- Updated version of @sap/odata-v4 to ^1.6.0\r\n\r\n### Fixed\r\n\r\n- Localization in case language is changed\r\n- Issue with not working $count when filtering active in custom hook\r\n\r\n## Version 0.7.0 - 2018-07-11\r\n\r\n### Added\r\n\r\n- Localization support for $metadata\r\n- Support for Compositions\r\n\r\n### Fixed\r\n\r\n- $search also considers foreign keys of managed associations, structured elements and complex types\r\n\r\n## Version 0.6.0 - 2018-07-02\r\n\r\n### Added\r\n\r\n- Multi tenancy support\r\n\r\n### Fixed\r\n\r\n- Columns are only added once to CQN in case of $expand in combination with $select\r\n\r\n## Version 0.5.0 - 2018-06-25\r\n\r\n### Added\r\n\r\n- Hooks\r\n  - An any handler can be registered and will be executed for any but COMMIT events\r\n  - Custom handlers can be registered for before COMMIT and after COMMIT events\r\n  - \"_\" property added to cds handler argument, which can contain adapter specific data like a request object\r\n\r\n- OData Service\r\n  - $filter supports (not) contains, startsWith, endsWith\r\n  - $filter supports combinations with and/or\r\n  - $select within $expand\r\n  - $apply supported with limited scope\r\n  - $search supported with limited scope\r\n\r\n### Changed\r\n\r\n- Hooks\r\n  - Undocumented OData specific properties removed from \"cds\" handler argument\r\n  - cds.target contains the unreflected entity instead of the reflected entity\r\n  - cds.error will collect errors and throw at the end of each block of .before, .on or .after handlers\r\n  - Second call to next() at a on handler will be ignored and not break the sequence\r\n\r\n### Fixed\r\n\r\n- Support navigation over entities with multiple keys\r\n\r\n### Removed\r\n\r\n- In case of a SerializationError the details are only logged and not provided in the response anymore\r\n\r\n## Version 0.4.1 - 2018-05-03\r\n\r\n### Changed\r\n\r\n- Updated version of @sap/cds-ql to 0.4.1\r\n\r\n## Version 0.4.0 - 2018-05-02\r\n\r\n### Added\r\n\r\n- service factory\r\n- cds used via injection\r\n\r\n- Hooks\r\n  - Support annotations @insertonly and @readonly\r\n  - Support reject registration for CSN entities\r\n  - Support reject registration with multiple entity parameters\r\n\r\n### Changed\r\n\r\n- default logger uses matching methods from console object instead of console.log\r\n- packages are loaded on demand at Services.js and OData.js instead of required in any case\r\n- adapted error message in case of 501\r\n\r\n## Version 0.3.0 - 2018-04-16\r\n### Added\r\n\r\n- service factory\r\n  - service.entities is set\r\n\r\n- OData Service\r\n  - Support for $expand=*\r\n  - Support for $select=*\r\n\r\n- Hooks\r\n  - CSN entities can be used instead of strings to register a handler\r\n  - .on can be registered with CQN instead of function as handler\r\n  - .on supports registering N handlers\r\n  - .on handlers can use a second argument next()\r\n  - .on can be finished by returning a value\r\n  - .after with convenience wrappers for each|row argument\r\n  - .after can now work asynchronously\r\n\r\n\r\n### Changed\r\n\r\n- server side paging is enabled by default and set to 100, to disable it set maxPageSize to false.\r\n\r\n- refactored service factory\r\n  - removed option to compile CSN on the fly, only CSN accepted as input format\r\n  - option to set the URL path is removed\r\n  - Multi service CSN can be used\r\n\r\n- refactored Service class\r\n  - OData service instantiation is now split in constructor, createODataService and getMiddleWare\r\n\r\n- OData Service\r\n  - Renamed parameters in handler context object (target replaces entity and getEntity)\r\n  - More expressive error messages\r\n  - Crash Node.js instance on unhandled error\r\n\r\n### Fixed\r\n\r\n- limit property is only added to CQN if necessary\r\n- .reply() is able to handle null values\r\n\r\n## Version 0.2.0 - 2018-03-16\r\n### Added\r\n\r\n- option to enable debug mode for odata-v4\r\n- default logger with option to register custom logger\r\n- support for server side paging\r\n- support for cds.serve, which is a Fluent API-style method to read service definitions from the given model(s) and construct services\r\n- usage of npm-shrinkwrap\r\n\r\n### Fixed\r\n\r\n- $filter in combination with to many association\r\n"},{"name":"README.md","content":"# @sap/cds-services\r\n\r\nThe `@sap/cds-runtime` module is the successor of `@sap/cds-services`. Please note that future development and bug fixes will be provided in the `@sap/cds-runtime` module only.\r\n\r\n## License\r\nThis package is provided under the terms of the [SAP Developer License Agreement](https://tools.hana.ondemand.com/developer-license-3.1.txt)."}]